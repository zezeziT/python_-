Python 列表推导式、生成器、map() 及相关容器学习笔记
目录
列表推导式简介

列表推导式示例

map() 函数与生成器

生成器表达式与列表推导式区别

元组与列表的区别

更多列表推导式实践示例

复杂表达式示例：π的不同精度表示

列表推导式简介
列表推导式（List Comprehension）是一种简洁优雅的生成列表的写法。

它可以对序列或可迭代对象中的每个元素执行操作，并生成一个新的列表。

也可以结合条件筛选出满足特定条件的元素，形成子列表。

列表推导式示例
python
复制
编辑
# 传统写法：创建平方值列表
squares = []
for x in range(10):
    squares.append(x**2)
print(squares)  # 输出平方列表
print(x)        # 变量 x 循环后仍存在，值为 9

# 列表推导式写法（更简洁）
squares = [y**2 for y in range(10)]
print(squares)
# print(y)  # 这行会报错，y 是局部变量，推导式执行完即销毁
map() 函数与生成器
map(function, iterable) 会把函数应用到可迭代对象每个元素上，返回一个“懒惰”的迭代器（generator）。

它不会立即计算所有结果，需要通过 list()、for 循环等方法“拉取”数据。

python
复制
编辑
# 使用 map 和 lambda 表达式生成平方列表
squares = map(lambda x: x**2, range(10))
print(list(squares))  # 需要用 list() 转换才能看到结果

# 定义普通函数并用 map 调用
def square(x):
    return x**2
nums = [1, 2, 3, 4]
result = map(square, nums)
print(list(result))

# 同样用 lambda 写法
result = map(lambda x: x**2, [1, 2, 3, 4])
print(list(result))
生成器表达式与列表推导式区别
列表推导式返回的是一个列表，数据立即计算并存储。

生成器表达式返回的是一个生成器对象，数据按需计算，节省内存。

python
复制
编辑
lst = [(x, y) for x in [1, 2] for y in [3, 4]]  # 列表推导式，返回列表
gen = ((x, y) for x in [1, 2] for y in [3, 4])  # 生成器表达式，返回生成器

print(lst)          # [(1, 3), (1, 4), (2, 3), (2, 4)]
print(list(gen))    # [(1, 3), (1, 4), (2, 3), (2, 4)]
print(list(gen))    # [] 生成器用完即空
元组与列表的区别
容器类型	是否有序	是否可变	允许元素类型	是否允许重复	说明
列表 []	有序	可变	可混合	允许	灵活的序列，可添加、修改、删除元素
元组 ()	有序	不可变	可混合	允许	不可修改的固定数据组合，常用表示坐标等
集合 set	无序	可变	可哈希元素	不允许重复	不重复无序元素集合
字典 dict	有序（3.7+）	可变	键需可哈希	键不重复	键值对集合，键唯一

例子：

python
复制
编辑
a = [(1, 2)]   # 元组组成的列表
b = [[1, 2]]   # 列表组成的列表

# a[0][0] = 100  # 报错，元组不可变
a[0] = (9, 9)    # 可以改列表元素指向
b[0][0] = 100    # 列表元素内部可变
print(a, b)
更多列表推导式实践示例
python
复制
编辑
vec = [-4, -2, 0, 2, 4]

# 翻倍所有值
L0 = [x * 2 for x in vec]
print(L0)

# 过滤负数，只保留非负数
L1 = [x for x in vec if x >= 0]
print(L1)

# 取绝对值
L2 = [abs(x) for x in vec]
print(L2)

# 去除字符串首尾空白字符（strip方法）
freshfruit = {'  banana', '    loganberry', 'passion fruit'}
s = [weapon.strip() for weapon in freshfruit]
print(s)

# 创建数字及平方的元组列表
sq = [(x, x**2) for x in range(10)]
print(sq)

# 展开嵌套列表为平铺列表
vec = [[1,2,3], [4,5,6], [7,8,9]]
f = [y for x in vec for y in x]
print(f)

# 等价写法
ll = []
for x in vec:
    for y in x:
        ll.append(y)
print(ll)

# 元素为元组的列表
zeze = [x for x in [(1,2), (3,4), (5,6)]]
print(zeze)

# 扁平化列表
zeze = [y for x in [(1,2), (3,4), (5,6)] for y in x]
print(zeze)
复杂表达式示例：π的不同精度表示
python
复制
编辑
from math import pi

p = [str(round(pi, i)) for i in range(1, 6)]
print(p)
说明：

round(pi, i) 四舍五入 π 到第 i 位小数。

用 str() 转成字符串。

结果为字符串列表，依次展示 π 从一位小数到五位小数的近似值。